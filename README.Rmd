---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)

library(tidyverse)
```

# rwpfunctionality

<!-- badges: start -->
<!-- badges: end -->

This package offers users comprehensive documentation on surveys conducted to assess water point functionality and management committees. These surveys were carried out across nine countries in both sub-Saharan Africa and South Asia.

## Installation

You can install the development version of rwpfunctionality from [GitHub](https://github.com/) with:

```{r}
# install.packages("devtools")
devtools::install_github("openwashdata/rwpfunctionality")
```

Alternatively, you can download the individual datasets as a CSV or XLSX
file from the table below.

```{r, echo=FALSE, message=FALSE, warning=FALSE}

extdata_path <- "https://github.com/openwashdata/rwpfunctionality/raw/main/inst/extdata/"

read_csv("data-raw/dictionary.csv") |> 
  distinct(file_name) |> 
  dplyr::mutate(file_name = str_remove(file_name, ".rda")) |> 
  dplyr::rename(dataset = file_name) |> 
  mutate(
    CSV = paste0("[Download CSV](", extdata_path, dataset, ".csv)"),
    XLSX = paste0("[Download XLSX](", extdata_path, dataset, ".xlsx)")
  ) |> 
  knitr::kable()

```

## Project goal

Sustained functionality of rural water systems is a global challenge. Addressing premature failures and unreliable performance of water points is crucial to achieve the 2030 Sustainable Development Goal (SDG) 6, which calls for universal and equitable access to safe and affordable drinking water for all (WHO, 2017). As of 2020, 771 million people lacked a basic water service (WHO & UNICEF, 2021). Yet even for those with water services, unreliable water infrastructure that provides intermittent supply, or is broken down or abandoned, contributes to unsustainable and unsafe water access worldwide (Allaire et al., 2018; Burt et al., 2018; Klug et al., 2018; Valcourt et al., 2020).


## Data

The data set includes observations of water point functionality and management committee questionnaires.

```{r, echo=FALSE}
library(rwpfunctionality)
library(leaflet)

map <- leaflet(rwpfunctionality) %>%
  addTiles() %>%
  addMarkers(~longitude_wp, ~latitude_wp,
             popup = ~paste("Elevation:", elevation_wp))

map
```

The package provides access to one single data set.

```{r, echo = TRUE}
library(rwpfunctionality)
```

The `rwpfunctionality` data set has `r ncol(rwpfunctionality)`
variables and `r nrow(rwpfunctionality)` observations. For an overview
of the variable names, see the following table.

```{r, eval=FALSE}
rwpfunctionality
```

```{r, echo=FALSE}
readr::read_csv("data-raw/dictionary.csv", col_types = NULL) |> 
  dplyr::filter(file_name == "rwpfunctionality.rda") |> 
  dplyr::select(variable_name:description) |> 
  knitr::kable()
```

## Example

### Pie Chart of Water Points Functionality

What are the statuses of the water points? Are they functional?

```{r}

library(dplyr)
library(ggplot2)

# Define custom colors
custom_colors <- c("lightblue", "orange", "purple")

# Create the pie chart with legend at the right
rwpfunctionality %>%
  count(functional3) %>%
  ggplot(aes(x = "", y = n, fill = functional3)) +
  geom_bar(stat = "identity") +
  coord_polar("y", start = 0) +
  scale_fill_manual(values = custom_colors) +  # Set custom colors
  labs(title = "Functionality rating for water points", fill = NULL,
       x = "",  # Empty x-axis label
       y = "Count") +  # y-axis label
  scale_fill_manual(labels = c("Functional", "Partially functional", "Abandoned or not functional"),
                    values = custom_colors)  # Custom legend labels


```
Based on this pie chart, it could be interesting to redefine the category "Partially functional" to gain insights and precision on this aspect of the data. However, we still clearly see that only a small part of the water points are functional.

## License

Data are available as 
[CC-BY](https://github.com/openwashdata/rwpfunctionality/LICENSE.md).

## Citation

To cite this package, please use:

```{r}
citation("rwpfunctionality")
```


